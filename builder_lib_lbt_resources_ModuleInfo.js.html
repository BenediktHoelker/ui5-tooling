<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>builder/lib/lbt/resources/ModuleInfo.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AbstractAdapter.html">AbstractAdapter</a><ul class='methods'><li data-type='method'><a href="AbstractAdapter.html#_byPath">_byPath</a></li><li data-type='method'><a href="AbstractAdapter.html#_runGlob">_runGlob</a></li><li data-type='method'><a href="AbstractAdapter.html#_write">_write</a></li><li data-type='method'><a href="AbstractAdapter.html#byGlob">byGlob</a></li><li data-type='method'><a href="AbstractAdapter.html#byPath">byPath</a></li><li data-type='method'><a href="AbstractAdapter.html#write">write</a></li></ul></li><li><a href="AbstractBuilder.html">AbstractBuilder</a><ul class='methods'><li data-type='method'><a href="AbstractBuilder.html#addTask">addTask</a></li><li data-type='method'><a href="AbstractBuilder.html#build">build</a></li></ul></li><li><a href="AbstractFormatter.html">AbstractFormatter</a></li><li><a href="AbstractReader.html">AbstractReader</a><ul class='methods'><li data-type='method'><a href="AbstractReader.html#_byGlob">_byGlob</a></li><li data-type='method'><a href="AbstractReader.html#_byPath">_byPath</a></li><li data-type='method'><a href="AbstractReader.html#_runGlob">_runGlob</a></li><li data-type='method'><a href="AbstractReader.html#byGlob">byGlob</a></li><li data-type='method'><a href="AbstractReader.html#byPath">byPath</a></li></ul></li><li><a href="AbstractReaderWriter.html">AbstractReaderWriter</a><ul class='methods'><li data-type='method'><a href="AbstractReaderWriter.html#_byGlob">_byGlob</a></li><li data-type='method'><a href="AbstractReaderWriter.html#_byPath">_byPath</a></li><li data-type='method'><a href="AbstractReaderWriter.html#_runGlob">_runGlob</a></li><li data-type='method'><a href="AbstractReaderWriter.html#_write">_write</a></li><li data-type='method'><a href="AbstractReaderWriter.html#byGlob">byGlob</a></li><li data-type='method'><a href="AbstractReaderWriter.html#byPath">byPath</a></li><li data-type='method'><a href="AbstractReaderWriter.html#write">write</a></li></ul></li><li><a href="DuplexCollection.html">DuplexCollection</a><ul class='methods'><li data-type='method'><a href="DuplexCollection.html#_runGlob">_runGlob</a></li><li data-type='method'><a href="DuplexCollection.html#byGlob">byGlob</a></li><li data-type='method'><a href="DuplexCollection.html#byGlobSource">byGlobSource</a></li><li data-type='method'><a href="DuplexCollection.html#byPath">byPath</a></li><li data-type='method'><a href="DuplexCollection.html#write">write</a></li></ul></li><li><a href="FileSystem.html">FileSystem</a><ul class='methods'><li data-type='method'><a href="FileSystem.html#byGlob">byGlob</a></li><li data-type='method'><a href="FileSystem.html#byPath">byPath</a></li><li data-type='method'><a href="FileSystem.html#write">write</a></li></ul></li><li><a href="Memory.html">Memory</a><ul class='methods'><li data-type='method'><a href="Memory.html#byGlob">byGlob</a></li><li data-type='method'><a href="Memory.html#byPath">byPath</a></li><li data-type='method'><a href="Memory.html#write">write</a></li></ul></li><li><a href="ReaderCollection.html">ReaderCollection</a><ul class='methods'><li data-type='method'><a href="ReaderCollection.html#_runGlob">_runGlob</a></li><li data-type='method'><a href="ReaderCollection.html#byGlob">byGlob</a></li><li data-type='method'><a href="ReaderCollection.html#byPath">byPath</a></li></ul></li><li><a href="ReaderCollectionPrioritized.html">ReaderCollectionPrioritized</a><ul class='methods'><li data-type='method'><a href="ReaderCollectionPrioritized.html#_runGlob">_runGlob</a></li><li data-type='method'><a href="ReaderCollectionPrioritized.html#byGlob">byGlob</a></li><li data-type='method'><a href="ReaderCollectionPrioritized.html#byPath">byPath</a></li></ul></li><li><a href="Resource.html">Resource</a><ul class='methods'><li data-type='method'><a href="Resource.html#buffer">buffer</a></li><li data-type='method'><a href="Resource.html#clone">clone</a></li><li data-type='method'><a href="Resource.html#getBuffer">getBuffer</a></li><li data-type='method'><a href="Resource.html#getPath">getPath</a></li><li data-type='method'><a href="Resource.html#getPathTree">getPathTree</a></li><li data-type='method'><a href="Resource.html#getStatInfo">getStatInfo</a></li><li data-type='method'><a href="Resource.html#getStream">getStream</a></li><li data-type='method'><a href="Resource.html#getString">getString</a></li><li data-type='method'><a href="Resource.html#pushCollection">pushCollection</a></li><li data-type='method'><a href="Resource.html#setBuffer">setBuffer</a></li><li data-type='method'><a href="Resource.html#setPath">setPath</a></li><li data-type='method'><a href="Resource.html#setStream">setStream</a></li><li data-type='method'><a href="Resource.html#setString">setString</a></li></ul></li><li><a href="Trace.html">Trace</a></li></ul><h3>Modules</h3><ul><li><a href="module-builder_builder.html">builder/builder</a><ul class='methods'><li data-type='method'><a href="module-builder_builder.html#~build">build</a></li></ul></li><li><a href="module-builder_processors_bundlers_flexChangesBundler.html">builder/processors/bundlers/flexChangesBundler</a></li><li><a href="module-builder_processors_bundlers_manifestBundler.html">builder/processors/bundlers/manifestBundler</a></li><li><a href="module-builder_processors_bundlers_moduleBundler.html">builder/processors/bundlers/moduleBundler</a></li><li><a href="module-builder_processors_debugFileCreator.html">builder/processors/debugFileCreator</a></li><li><a href="module-builder_processors_resourceCopier.html">builder/processors/resourceCopier</a></li><li><a href="module-builder_processors_stringReplacer.html">builder/processors/stringReplacer</a></li><li><a href="module-builder_processors_themeBuilder.html">builder/processors/themeBuilder</a></li><li><a href="module-builder_processors_uglifier.html">builder/processors/uglifier</a></li><li><a href="module-builder_processors_versionInfoGenerator.html">builder/processors/versionInfoGenerator</a></li><li><a href="module-builder_tasks_buildThemes.html">builder/tasks/buildThemes</a></li><li><a href="module-builder_tasks_bundlers_generateBundle.html">builder/tasks/bundlers/generateBundle</a></li><li><a href="module-builder_tasks_bundlers_generateComponentPreload.html">builder/tasks/bundlers/generateComponentPreload</a></li><li><a href="module-builder_tasks_bundlers_generateFlexChangesBundle.html">builder/tasks/bundlers/generateFlexChangesBundle</a></li><li><a href="module-builder_tasks_bundlers_generateLibraryPreload.html">builder/tasks/bundlers/generateLibraryPreload</a></li><li><a href="module-builder_tasks_bundlers_generateManifestBundle.html">builder/tasks/bundlers/generateManifestBundle</a></li><li><a href="module-builder_tasks_bundlers_generateStandaloneAppBundle.html">builder/tasks/bundlers/generateStandaloneAppBundle</a></li><li><a href="module-builder_tasks_createDebugFiles.html">builder/tasks/createDebugFiles</a></li><li><a href="module-builder_tasks_generateLibraryManifest.html">builder/tasks/generateLibraryManifest</a></li><li><a href="module-builder_tasks_generateVersionInfo.html">builder/tasks/generateVersionInfo</a></li><li><a href="module-builder_tasks_replaceCopyright.html">builder/tasks/replaceCopyright</a></li><li><a href="module-builder_tasks_replaceVersion.html">builder/tasks/replaceVersion</a></li><li><a href="module-builder_tasks_uglify.html">builder/tasks/uglify</a></li><li><a href="module-init_init.html">init/init</a></li><li><a href="module-normalizer_normalizer.html">normalizer/normalizer</a><ul class='methods'><li data-type='method'><a href="module-normalizer_normalizer.html#~generateDependencyTree">generateDependencyTree</a></li><li data-type='method'><a href="module-normalizer_normalizer.html#~generateProjectTree">generateProjectTree</a></li></ul></li><li><a href="module-normalizer_translators_npm.html">normalizer/translators/npm</a><ul class='methods'><li data-type='method'><a href="module-normalizer_translators_npm.html#.generateDependencyTree">generateDependencyTree</a></li></ul></li><li><a href="module-normalizer_translators_static.html">normalizer/translators/static</a><ul class='methods'><li data-type='method'><a href="module-normalizer_translators_static.html#.processTree">processTree</a></li><li data-type='method'><a href="module-normalizer_translators_static.html#~generateDependencyTree">generateDependencyTree</a></li></ul></li><li><a href="module-resources_fsInterface.html">resources/fsInterface</a></li><li><a href="module-resources_resourceFactory.html">resources/resourceFactory</a><ul class='methods'><li data-type='method'><a href="module-resources_resourceFactory.html#~createAdapter">createAdapter</a></li><li data-type='method'><a href="module-resources_resourceFactory.html#~createCollectionsForTree">createCollectionsForTree</a></li><li data-type='method'><a href="module-resources_resourceFactory.html#~createResource">createResource</a></li><li data-type='method'><a href="module-resources_resourceFactory.html#~createWorkspace">createWorkspace</a></li></ul></li><li><a href="module-server_middleware_discovery.html">server/middleware/discovery</a></li><li><a href="module-server_middleware_nonReadRequests.html">server/middleware/nonReadRequests</a></li><li><a href="module-server_middleware_serveIndex.html">server/middleware/serveIndex</a></li><li><a href="module-server_middleware_serveResources.html">server/middleware/serveResources</a></li><li><a href="module-server_middleware_serveThemes.html">server/middleware/serveThemes</a></li><li><a href="module-server_middleware_versionInfo.html">server/middleware/versionInfo</a></li><li><a href="module-server_server.html">server/server</a></li><li><a href="module-server_sslUtil.html">server/sslUtil</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createContent">createContent</a></li><li><a href="global.html#createResourceInfo">createResourceInfo</a></li><li><a href="global.html#createResourceInfos">createResourceInfos</a></li><li><a href="global.html#formatSize">formatSize</a></li><li><a href="global.html#getMimeType">getMimeType</a></li><li><a href="global.html#getStringArray">getStringArray</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">builder/lib/lbt/resources/ModuleInfo.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

/**
 * A strict dependency always has to be fulfilled and is declared as part of the module's definition.
 * @private
 */
const STRICT = 0;

/**
 * An implicit dependency is also strict, but has not been declared. E.g. each UI5 module depends on
 * jquery.sap.global.
 * @private
 */
const IMPLICIT = 1;

/**
 * A conditional dependency has to be resolved only under certain conditions that typically are
 * checked at runtime.
 * @private
 */
const CONDITIONAL = 2;

const Format = {
	UI5_LEGACY: "ui5-declare",
	UI5_DEFINE: "ui5-define",
	AMD: "amd"
};

/**
 * Information about an existing Module and its dependencies.
 *
 * @author Frank Weigel
 * @since 1.1.2
 * @private
 */
class ModuleInfo {
	constructor(name) {
		this.name = name;
		this.subModules = [];
		this._dependencies = {};
		this.dynamicDependencies = false;

		/**
		 * Description of the module
		 */
		this.description = undefined;

		/**
		 * Module format used by this module.
		 *
		 * @type {Format}
		 */
		this.format = undefined;

		/**
		 * 'raw' modules are modules that don't use UI5's module system (require/declare)
		 * TODO align with module format (ui5, amd, es6, raw)
		 */
		this.rawModule = false;

		/**
		 * Whether the module requires top level scope (true) or whether it can be embedded
		 * in another function scope (e.g. for preload).
		 *
		 * Even when a module declares top level variables, it might be possible to embed it
		 * when all of the following criteria are met:
		 * &lt;ul>
		 * &lt;li>all relevant global variables are set during the execution of the module
		 * &lt;li>all relevant global variables are treated like "const", e.g. they are only
		 *		 set once and not modified afterwards
		 * &lt;/ul>
		 *
		 * The module analyzer doesn't recognize whether these criteria are met.
		 * Instead, developers can provide this information in the raw-modules section of
		 * the corresponding .library file. By default, any modules is assumed NOT to require
		 * global scope. If a module declares global variables, all of them will be exported
		 * with additional code of the form:
		 *
		 * &lt;pre>
		 *	 this["name"] = name;
		 * &lt;/pre>
		 *
		 * To avoid this, developers can either add "name" to the &lt;code>ignoreGlobals&lt;/code>
		 * attribute of a raw-module or they can completely suppress embedding of the module
		 * by setting the &lt;code>requiresTopLevelScope&lt;/code> attribute to &lt;code>true&lt;/code>.
		 *
		 * @returns	Whether the module requires top level scope.
		 */
		this.requiresTopLevelScope = false;

		/**
		 * Global names that the module exposes intentionally and that should be exported
		 * when the module is wrapped in another scope (e.g. for function preload).
		 *
		 * Implementation Note: during module analysis, this collections contains all global names.
		 * Based on external metadata (shims), ignorable names are removed from the collection.
		 */
		this.exposedGlobals = undefined;
	}

	_addDependency(dependency, kind) {
		// add the dependency only when it is defined, not empty,
		// not equal to the current module itself and if the same module is not
		// included already as a submodule.
		// If the dependency was known already, update the kind
		// only when the new kind is stronger than the current one.
		// STRICT is stronger than IMPLICIT, IMPLICIT is stronger than CONDITIONAL
		if ( dependency
				&amp;&amp; dependency !== this.name
				&amp;&amp; this.subModules.indexOf(dependency) &lt; 0
				&amp;&amp; ( !(dependency in this._dependencies) || kind &lt; this._dependencies[dependency]) ) {
			this._dependencies[dependency] = kind;
		}
	}

	addImplicitDependency(dependency) {
		this._addDependency(dependency, IMPLICIT);
	}

	addDependency(dependency, conditional) {
		this._addDependency(dependency, conditional ? CONDITIONAL : STRICT);
	}

	setFormat(detectedFormat) {
		if ( this.format == null
				|| detectedFormat === Format.UI5_LEGACY
				|| (detectedFormat === Format.UI5_DEFINE &amp;&amp; this.format !== Format.UI5_LEGACY) ) {
			this.format = detectedFormat;
		}
	}

	/**
	 * Adds the given module as a sub module to this module.
	 *
	 * If the module is an instanceof ModuleInfo, its name is added to submodules,
	 * its dependencies become dependencies of this module (if they are not already
	 * included as submodules). If the included module has calculated (dynamic)
	 * dependencies, then this module inherits this 'quality'.
	 *
	 * Other data (like size, top level vars etc.) is not aggregated here as
	 * the correct aggregation highly depends on the way how the module is merged
	 * (preload, legacy embedding, raw module, ...)
	 *
	 * If other is a string, it is simply added to subModules.
	 *
	 * @param {string | ModuleInfo} other Module to include into this module
	 */
	addSubModule( other ) {
		if ( other instanceof ModuleInfo ) {
			this.addSubModule( other.name );
			// accumulate dependencies
			for ( let dep in other._dependencies ) {
				if (other._dependencies.hasOwnProperty(dep)) {
					this._addDependency(dep, other._dependencies[dep]);
				}
			}
			// inherit dynamic dependencies
			if ( other.dynamicDependencies ) {
				this.dynamicDependencies = true;
			}
		} else {
			this.subModules.push( other );
			// when a module is added as submodule, it no longer is a dependency
			delete this._dependencies[other];
		}
	}

	isConditionalDependency(dependency) {
		return this._dependencies[dependency] === CONDITIONAL;
	}

	isImplicitDependency(dependency) {
		return this._dependencies[dependency] === IMPLICIT;
	}

	get dependencies() {
		return Object.keys(this._dependencies);
	}

	toString() {
		return "ModuleInfo(" +
			this.name +
			", dependencies=" + this.dependencies +
			", includes=" + this.subModules +
			")";
	}
}

// expose format enum
ModuleInfo.Format = Format;

/* NODE-TODO
public class ModuleInfo {

	private String resourcePath;

	private String description;

	private File file;

	private long size;

	private long compressedSize = -1;

	private boolean rawModule;

	/**
	 * Whether the module must not run automatically (e.g. because it is to be used only in certain contexts)
	 *
	 * This is relevant during the generation of the all-in-one files.
	 *
	private boolean excludeFromAllInOne;


	public void removeIgnoredGlobalNames(Collection&lt;String> ignoredNames) {
		if ( !exposedGlobals.isEmpty() ) {
			exposedGlobals.removeAll(ignoredNames);
		}
	}

} */

module.exports = ModuleInfo;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Nov 06 2018 11:30:46 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
